{"version":3,"file":"typed-conversions.min.js","sources":["../lib/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst get = require(\"lodash.get\");\nfunction removeIdPropertyFromHash(hash, idProp = \"id\") {\n    const output = {};\n    Object.keys(hash).map((objId) => {\n        const input = hash[objId];\n        output[objId] = {};\n        Object.keys(input).map(prop => {\n            if (prop !== idProp) {\n                output[objId][prop] = input[prop];\n            }\n        });\n    });\n    return output;\n}\nexports.removeIdPropertyFromHash = removeIdPropertyFromHash;\nfunction keyValueDictionaryToArray(dict) {\n    return Object.keys(dict).reduce((result, key) => {\n        return result.concat({ key, value: dict[key] });\n    }, []);\n}\nexports.keyValueDictionaryToArray = keyValueDictionaryToArray;\nfunction hashToArray(hashObj, __key__ = \"id\") {\n    if (hashObj && typeof hashObj !== \"object\") {\n        throw new Error(\"Cant convert hash-to-array because hash was not passed in: \" + hashObj);\n    }\n    const hash = Object.assign({}, hashObj);\n    const results = [];\n    Object.keys(hash).forEach(id => {\n        const obj = hash[id];\n        const allEqualTrue = (prev, curr) => {\n            return obj[curr] !== true ? false : prev;\n        };\n        const isScalar = Object.keys(obj).reduce(allEqualTrue, true) ? true : false;\n        const isSimpleArray = Object.keys(obj).every(i => hash[i] === true);\n        const key = isScalar\n            ? isSimpleArray\n                ? results.push(id)\n                : results.push(Object.assign({ [__key__]: id }, { value: hash[id] }))\n            : results.push(isScalar ? id : Object.assign({}, obj, { [__key__]: id }));\n    });\n    return results;\n}\nexports.hashToArray = hashToArray;\nfunction flatten(list) {\n    return list.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), []);\n}\nexports.flatten = flatten;\nfunction arrayToHash(arr, keyProperty) {\n    if (arr.length === 0) {\n        return {};\n    }\n    const isScalar = typeof arr[0] === \"object\" ? false : true;\n    if (isScalar && keyProperty) {\n        const e = new Error(`You can not have an array of primitive values AND set a keyProperty!`);\n        e.name = \"NotAllowed\";\n        throw e;\n    }\n    if (!keyProperty && !isScalar) {\n        if (arr[0].hasOwnProperty(\"id\")) {\n            keyProperty = \"id\";\n        }\n        else {\n            const e = new Error(`Tried to default to a keyProperty of \"id\" but that property does not appear to be in the array passed in`);\n            e.name = \"NotAllowed\";\n            throw e;\n        }\n    }\n    if (!Array.isArray(arr)) {\n        const e = new Error(`arrayToHash: input was not an array!`);\n        e.name = \"NotAllowed\";\n        throw e;\n    }\n    const output = arr.reduce((prev, curr) => {\n        const key = isScalar ? curr : curr[keyProperty];\n        return isScalar\n            ? Object.assign({}, prev, { [key]: true }) : Object.assign({}, prev, { [key]: curr });\n    }, {});\n    return output;\n}\nexports.arrayToHash = arrayToHash;\nfunction snapshotToArray(snap, idProp = \"id\") {\n    const hash = snap.val() || {};\n    return hashToArray(hash, idProp);\n}\nexports.snapshotToArray = snapshotToArray;\nfunction snapshotToHash(snap, idProp = \"id\") {\n    const hash = snap.val() || {};\n    Object.keys(hash).forEach(key => typeof hash[key] === \"object\"\n        ? (hash[key][idProp] = key)\n        : (hash[key] = { [idProp]: key, value: hash[key] }));\n    return hash;\n}\nexports.snapshotToHash = snapshotToHash;\nfunction snapshotToOrderedArray(snap, idProp = \"id\") {\n    const output = [];\n    snap.forEach((child) => {\n        const obj = child.val();\n        const key = child.key;\n        if (typeof obj !== \"object\") {\n            throw new Error(`Can't create a list from scalar values: \"${obj}\" | \"${key}\"`);\n        }\n        output.push(Object.assign({ [idProp]: key }, obj));\n        return true;\n    });\n    return output;\n}\nexports.snapshotToOrderedArray = snapshotToOrderedArray;\nfunction snapshotToOrderedHash(snap, idProp = \"id\") {\n    const orderedArray = this.snapshotToOrderedArray(snap, idProp);\n    return this.arrayToHash(orderedArray);\n}\nexports.snapshotToOrderedHash = snapshotToOrderedHash;\nfunction getPropertyAcrossDictionaryItems(dictionary, property) {\n    const output = [];\n    Object.keys(dictionary).map(item => {\n        const value = get(dictionary[item], property, undefined);\n        if (value !== undefined) {\n            output.push(value);\n        }\n    });\n    return output;\n}\nexports.getPropertyAcrossDictionaryItems = getPropertyAcrossDictionaryItems;\n//# sourceMappingURL=index.js.map"],"names":["Object","defineProperty","exports","get","require","hashToArray","hashObj","__key__","_typeof","Error","hash","assign","results","keys","forEach","obj","id","isScalar","reduce","prev","curr","isSimpleArray","every","i","push","removeIdPropertyFromHash","idProp","output","map","objId","input","prop","keyValueDictionaryToArray","dict","result","key","concat","flatten","list","a","b","Array","isArray","arrayToHash","arr","keyProperty","length","e","name","hasOwnProperty","snapshotToArray","snap","val","snapshotToHash","snapshotToOrderedArray","child","snapshotToOrderedHash","orderedArray","this","getPropertyAcrossDictionaryItems","dictionary","property","value","item","undefined"],"mappings":"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"}